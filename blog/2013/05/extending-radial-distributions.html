<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Extending Radial Distributions</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Interesting thoughts and tutorials from the White Lab at the University of Rochester.">
    <link rel="canonical" href="https://thewhitelab.org/blog/2013/05/extending-radial-distributions.html">

    <!-- Jquery -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <!-- Font -->
    <link href='https://fonts.googleapis.com/css?family=Merriweather:400,700,400italic' rel='stylesheet'
        type='text/css'>

    <!-- Bootstrap -->
    
  <!-- AUTOMATICALLY GENERATED. DO NOT EDIT. -->
  
  
    <link rel="stylesheet" type="text/css" href="/blog/bootstrap/css/bootstrap.min.css" />


    <!-- MathJax https version -->
    

    

</head>

    <body>

    <header class="site-header">

  <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/blog/#">Blog Home</a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><a href="/blog/post_list">Posts</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li><a href="https://thewhitelab.org">thewhitelab.org</a></li>
        </ul>
      </div>
      <!--/.nav-collapse -->
    </div>
    <!--/.container-fluid -->
  </div>

</header>

    <div class="container">
      <div class="container">

  <div class="row">
    <div class="post-header col-md-8 col-md-offset-2">
      <h1>Extending Radial Distributions</h1>
      
      <p class="text-muted">May 17, 2013 â€¢ Andrew White</p>
    </div>
  </div>

  <article class="post-content">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <div class="css-full-post-content js-full-post-content">
<a href="http://en.wikipedia.org/wiki/Radial_distribution_function">Radial distribution functions</a> are one of the most important quantities to calculate when running a molecular dynamics simulation. They give good insight into the phase and pair potentials between molecules. Practically, they are calculated according to the following equation:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-2wMtwtQ1SJc/UZXIab-R4OI/AAAAAAAABMY/ek2SAEuT_gk/s1600/1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-2wMtwtQ1SJc/UZXIab-R4OI/AAAAAAAABMY/ek2SAEuT_gk/s320/1.png" /></a></div><a name='more'></a><br /><br />where <code> v_i </code> is a small volume increment that corresponds to the radius increment <code>r_i</code>, <code> n_i </code> is the average number of particles found in the volume <code>v_i</code>, and <code> rho_bulk</code> is the bulk density of the entire simulation. Essentially, at each incremental volume we're calculating the ratio of particles found to what we would find if the particles in that volume behaved like the bulk density. The incremental volume in which we search for particles may be seen in the image below:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-hJqD51icd8I/UZXG4OpR2EI/AAAAAAAABL8/ICsH7GUQeyw/s1600/drawing.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-hJqD51icd8I/UZXG4OpR2EI/AAAAAAAABL8/ICsH7GUQeyw/s320/drawing.png" /></a></div>However, we notice there is a problem as <code> r_i </code> grows: the concentric circles (or spheres in 3D) begin to intersect with the simulation box that contains the particles. This is is shown below.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-69RbW25-nWA/UZXG4Np1BAI/AAAAAAAABL4/NktVUCcQKMM/s1600/drawing_2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-69RbW25-nWA/UZXG4Np1BAI/AAAAAAAABL4/NktVUCcQKMM/s320/drawing_2.png" /></a></div>Generally this problem is approached by stopping a radial distribution calculation when <code> r_i </code> is equal to half the side length of the simulation box. That actually means we lose a significant amount of statistics,  pi / 8 in 3 dimensions to be exact. This in fact may fixed by using the results of my <a href="http://crowsandcats.blogspot.com/2013/04/cube-sphere-intersection-volume.html"> previous post about cube-sphere intersections</a>. In fact, I wrote it specifically about this issue.<br /><br />The way to allow radial distribution functions to be calculated all the way out until all particles are counted is to calculate the true <code> v_i</code>, which is the intersection volume between the simulation box and the concentric spheres that make up <code> v_i </code>. Using the <a href="https://gist.github.com/whitead/a1dd345a1e9f96805513"> code I wrote</a>, <code> v_i </code> may be calculated according to:<br /><br /><script src="https://gist.github.com/whitead/67343ed96e5e981eaf28.js"></script> The relevant radial distribution function calculation now looks like this:<br /><script src="https://gist.github.com/whitead/766ffca0739fabad6113.js"></script> Finally, here are the results on Lennard-Jones fluid calculation:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-GoehLT_wBKA/UZXHy70Ix7I/AAAAAAAABMM/IJtx_PIboe0/s1600/gofr.png" imageanchor="1"><img border="0" src="http://1.bp.blogspot.com/-GoehLT_wBKA/UZXHy70Ix7I/AAAAAAAABMM/IJtx_PIboe0/s320/gofr.png" /></a></div><br />The simulation box ends at the end of the line. As you can see, there is a huge amount of space lost in traditional radial distribution function calculations. Another cool thing about correcting the volume is that the radial distribution does not have to be normalized to converge to 1. Often in these calculations people struggle with double counting and incorrect volumes so that the value is just forced to converge to 1 at the edge of the plot. That is the value which it should converge to. Here's the full radial distribution calculator, which is part of <a href="https://github.com/whitead/Simple-MD"> a simulation engine </a> I'm writing. <br /><br /><script src="https://gist.github.com/whitead/e381e2e6091548bae6a3.js"></script>
</div>
      </div>
    </div>
  </article>

</div>
    </div>

    <div id="footer" class="footer">

  <div class="container">
    <div class="row text-muted">
      <div class="col-md-4">
        &copy 2022 Andrew White
      </div>

      <div class="col-md-4">
      </div>

      <div class="col-md-4">
        <p class="text">Interesting thoughts and tutorials from the White Lab at the University of Rochester.</p>
      </div>
    </div>

  </div>

</div>

    </body>
</html>
