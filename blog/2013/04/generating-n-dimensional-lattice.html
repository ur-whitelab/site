<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Generating n-Dimensional Lattice Coordinates</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Interesting thoughts and tutorials from the White Lab at the University of Rochester.">
    <link rel="canonical" href="https://thewhitelab.org/blog/2013/04/generating-n-dimensional-lattice.html">

    <!-- Jquery -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <!-- Font -->
    <link href='https://fonts.googleapis.com/css?family=Merriweather:400,700,400italic' rel='stylesheet'
        type='text/css'>

    <!-- Bootstrap -->
    
  <!-- AUTOMATICALLY GENERATED. DO NOT EDIT. -->
  
  
    <link rel="stylesheet" type="text/css" href="/blog /bootstrap/css/bootstrap.min.css" />


    <!-- MathJax https version -->
    

    

</head>

    <body>

    <header class="site-header">

  <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/blog/#">Blog Home</a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><a href="/blog /post_list">Posts</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li><a href="https://thewhitelab.org">thewhitelab.org</a></li>
        </ul>
      </div>
      <!--/.nav-collapse -->
    </div>
    <!--/.container-fluid -->
  </div>

</header>

    <div class="container">
      <div class="container">

  <div class="row">
    <div class="post-header col-md-8 col-md-offset-2">
      <h1>Generating n-Dimensional Lattice Coordinates</h1>
      
      <p class="text-muted">Apr 24, 2013 â€¢ Andrew White</p>
    </div>
  </div>

  <article class="post-content">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <div class="css-full-post-content js-full-post-content">
It comes up sometimes in my research that I need to generate coordinates along a lattice. For example, when generating an initial structure for a molecular dynamics simulation. I thought I share my code for this. The code works by recursively enumerating each dimension in a lattice and calling a given function each time it reaches a point. So, it could be used to execute any function along a lattice. Here's what it looks like for a 2D and 3D example. In the 3D example I didn't choose a cubic number of points on the lattice, so that it sort of stops in the middle.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-DrEz-dJ5Lfo/UXf4t1Nt_1I/AAAAAAAABDg/U_onI_7bn0I/s1600/2dlattice.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="200" src="http://1.bp.blogspot.com/-DrEz-dJ5Lfo/UXf4t1Nt_1I/AAAAAAAABDg/U_onI_7bn0I/s320/2dlattice.png" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-n9_iLenPG2E/UXf4xqFsReI/AAAAAAAABDo/eAmP73FiF3I/s1600/3dlattice.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="200" src="http://3.bp.blogspot.com/-n9_iLenPG2E/UXf4xqFsReI/AAAAAAAABDo/eAmP73FiF3I/s320/3dlattice.png" width="320" /></a></div><br /><a name='more'></a><br /> Here's the code: <pre><br />#!/usr/bin/python<br /><br />import sys, copy<br /><br />from math import *<br /><br />def print_usage():<br />    print "Usage: build_lattice.py [dims] [box_1_size] [box_..._size] [box_dims_size] [number]"<br /><br />if(len(sys.argv) < 2):<br />    print_usage()<br />    exit()<br /><br />n_dims = int(sys.argv[1])<br /><br />if(len(sys.argv) < 2 + n_dims + 1):<br />    print_usage()<br />    exit()<br /><br /><br />box_size = [float(sys.argv[x]) for x in range(2,2+n_dims)]<br />number = int(sys.argv[2 + n_dims])<br />volume = 1<br />for x in box_size:<br />    volume = volume * x<br />increment = (volume / number) ** (1. / n_dims)<br /><br /><br />def prepend_emit(array, element):<br />    array_copy = copy.copy(array)<br />    array_copy.insert(0, element)<br />    return array_copy<br /><br />def enumerate_grid(fxn, dim, sizes, indices):<br />    if(dim > 0):<br />        for i in range(sizes[dim]):<br />            enumerate_grid(fxn, <br />                           dim - 1, <br />                           sizes, <br />                           prepend_emit(indices, i))<br /><br />    else:<br />        for i in range(sizes[dim]):<br />            fxn(prepend_emit(indices, i))<br /><br />def print_point(point):<br />    print point,<br /><br />def print_grid(indices):<br />    global number<br />    <br />    #check if to make sure we still need to make particles<br />    if(number > 0):<br />        number -= 1<br />        global increment<br />        [print_point(x * increment) for x in indices]<br />        print ""<br />        <br />enumerate_grid(print_grid, n_dims - 1, <br />               [int(ceil(x / increment)) for x in box_size], <br />               [])<br /><br /><br /></pre>
</div>
      </div>
    </div>
    
  </article>

</div>
    </div>

    <div id="footer" class="footer">

  <div class="container">
    <div class="row text-muted">
      <div class="col-md-4">
        &copy 2022 Andrew White
      </div>

      <div class="col-md-4">
      </div>

      <div class="col-md-4">
        <p class="text">Interesting thoughts and tutorials from the White Lab at the University of Rochester.</p>
      </div>
    </div>

  </div>

</div>

    </body>
</html>
