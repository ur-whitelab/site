<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>Dartmouth</title>

	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/theme/black.css">
	<link rel="stylesheet" href="css/reveal-override.css">

	<!-- Theme used for syntax highlighting of code -->
	<link rel="stylesheet" href="lib/css/zenburn.css">

	<!-- Printing and PDF exports -->
	<script>
		var link = document.createElement('link');
		link.rel = 'stylesheet';
		link.type = 'text/css';
		link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
		document.getElementsByTagName('head')[0].appendChild(link);

	</script>
</head>

<body>
	<div class="reveal" style="cursor: none;">

		<div class="slides">

			<div style="" class="footer">
				<p class="footer-img pull-left">
					<img src="img/URLogo.png" height="40px" />
				</p>
				<p class="pull-right footer-text">
					<span class="footer-link">
						<a href="http://thewhitelab.org"> http://thewhitelab.org</a>
					</span>|&nbsp;&nbsp; <span class="attn">@andrewwhite01 </span>
				</p>
			</div>
			<section class="center" data-background="#ffdd00">
				<h3 class="attn">Iterative Materials Discovery with Maximum Entropy Methods and Deep Learning</h3>

				<br>

				<p class="">
					Andrew White <br>
					<small>
						University of Rochester <br>
						Department of Chemical Engineering </small>

				</p>

				<p class="">
					<small> <i>
							Plumed Masterclass
							<br>April 2022</small></i>
				</p>
			</section>

			<section>
				<section data-background-video="mov/lj_plot_web.mp4" data-background-video-loop
					data-background-size="contain" data-background="#000" hide-footer="yes">
					<h4 class="bright">
						<span class="red">Simulation</span> goes from the interaction energy of molecules...
					</h4>

				</section>

				<section hide-footer="yes" data-background-video="mov/lj_sim_web.mp4" data-background-video-loop
					data-background-size="contain" data-background="#000000">
					<h4 class="bright">...to properties of ensembles of molecules</h4>
				</section>

				<section>

					<p>Most properties can be computed knowing the position of every atom \(f(\vec{r})\)</p>

					<p class="red"> Probability of any state: </p>
					$$P(\vec{r}) = \frac{1}{Z} e^{-\frac{U(\vec{r})}{kT}}$$

					<p class="red"> The observable ensemble average</p>
					$$ \left
					< f(\vec{r})\right> = \int d\vec{r}\, P(\vec{r})f(\vec{r}) $$
				</section>
				<section class="center" data-background="#ffdd00">
					<p> How can we use experimental data to improve simulations?</p>

					<img src="img/detailed_cycle_maxent.png" width="400px">
				</section>
			</section>
			<section>
				<section class="center" data-background="#ffdd00">
					<h2>Motivating Example</h2>
					<p>Using experimental data to create highly accurate peptide self-assembly simulations</p>
				</section>

				<section data-background="#FFF" hide-footer="yes">
					<p class="left-align">Peptides are chains of connected monomers chosen from a set of 20 amino acids
					</p>
					<div class="frag-container">
						<div class="fragment fade-out multi-frag" data-fragment-index="1">
							<div>
								<img src="img/aa_introduction_1.svg" width="800px" />
							</div>
						</div>
						<div class="fragment fade-in multi-frag" data-fragment-index="1">
							<div>
								<img src="img/aa_introduction_2.svg" width="800px" />
							</div>
						</div>
					</div>
				</section>
				<section data-background="#ffdd00" class="center">
					<p>There are about $10^{30}$ synthesizable peptides</p>
					<br>
					<p class="left-align"> Examples:</p>

					<ul class="pull-left">
						<li><code>AARKPIV</code></li>
						<li><code>FF</code></li>
						<li><code>RGD</code></li>
						<li><code>CPPPPEKEKEKEKEY</code></li>
					</ul>
				</section>
				<section data-background-image="img/sizes.png" data-background-size="contain" hide-footer="yes">
				</section>

				<section data-background="#FFF" hide-footer="yes">
					<p>A\(\beta\) is believed to be the toxin which causes symptoms of Alzhiemer's Disease</p>
					<p class="red"> Accuracy, time, and length challenge</p>
					<video data-autoplay height="400" loop>
						<source src="mov/abeta_rot.mp4" type="video/mp4" />
					</video>
					<div class="footnotes">
						Crescenzi, O. et al.
						<i> Eur. J. Biochem </i>
						<strong> 2002</strong>
					</div>
				</section>
				<section hide-footer="yes" class="center">
					<h3> What can we study with 21-30 Fragment?</h3>
					<ol>
						<li>Can simulation without external data model this system?</li>
						<li>What is the structure of this fragment?</li>
						<li>How does the fragment interact? Does it nucleate?</li>
						<li>Why do co-mutations affect aggregation rates?</li>
					</ol>

					<div class="footnotes">
						Grant, M. A. et al.
						<i> PNAS </i>
						<strong> 2007</strong> 104, p 16522-7
					</div>
				</section>
				<section data-background-color="#FFF">
					<h3>Current methods give high inaccuracy</h3>
					<img src="img/simple_1_copy_control_.png" width="450px">
					<p><small>40 ns of 21-30 single fragment in NVT 278K MD with Gromacs Amber 99sb-ildn. H NMR chemical
							shift cumulative error is plotted for
							each backbone amino acid.
						</small></p>
				</section>
				<section class="center" data-background="#ffdd00">
					<p class="">Can we improve this force-field by adding the experimental data as input?</p>
					<img src="img/eds.png" width="400px">
				</section>
			</section>
			<section>
				<section class="center" hide-footer="yes" data-background="#FFF">
					<h4> Small Data Learning</h4>

					<p>
						<small>
							Improve complex approximately correct model with small amount of training data
						</small>
					</p>

					<img src="img/all_models.png" class="stretch" />

					<div class="footnotes">
						<ol class="pull-left">
							<li> J Pitera & J Chodera
								<i> J Chem Theory Comput </i>
								<strong> 2012</strong> 8:3445
							</li>
							<li> B Roux & J Weare
								<i> J Chem Phys </i>
								<strong> 2013</strong> 138:084107
							</li>
							<li> AD White & GA Voth
								<i> J Chem Theory Comput </i>
								<strong> 2014</strong> 10:3023
							</li>
						</ol>

					</div>
				</section>

				<section class="center" hide-footer="yes" data-background="#FFF">

					<h4>Maximum Entropy</h4>

					<div class="container">
						<div class="small">
							<ul>
								<li> \( P_0(\vec{r}) \) Unbiased Model</li>
								<li> \( f(\vec{r}) \) Observable property</li>
								<br>
								<li> \( \left
									< f(\vec{r})\right> = \int d\vec{r}\, P'(\vec{r})f(\vec{r}) = \hat{f} \)
								</li>
								<br>
								<li>\( \Delta S_{\textrm{rel}} = \int d\vec{r}\, P(\vec{r})\ln
									\frac{P(\vec{r})}{P'(\vec{r})} \)</li>
							</ul>
						</div>
						<div>
							<img src="img/math_models.png" />
						</div>
					</div>

					<p class="attn"> Minimize \( \Delta S_{\textrm{rel}}\) while satisfying \( \left
						< f(\vec{r})\right> = \hat{f} \)</s>
					</p>

					<div class="footnotes">
						<ol class="pull-left">
							<li> J Pitera & J Chodera
								<i> J Chem Theory Comput </i>
								<strong> 2012</strong> 8:3445
							</li>
							<li> B Roux & J Weare
								<i> J Chem Phys </i>
								<strong> 2013</strong> 138:084107
							</li>
							<li> AD White & GA Voth
								<i> J Chem Theory Comput </i>
								<strong> 2014</strong> 10:3023
							</li>
						</ol>

					</div>
				</section>

				<section class="center">
					<h4> The Minimal Ensemble is</h4>

					$$P'(\vec{r}) = P_0(\vec{r})e^{-\alpha f(x)}$$
					<br>

					<h4> The Minimal Bias Added to Potential Energy is </h4>

					$$U'(x) = U(x) + \alpha f(x)$$

					<br>
					<h4> To Make</h4>

					$$&lt;f(x)&gt; = \hat{f}$$
					</br>

				</section>

				<section class="center">
					<p class="attn">
						A linear bias is minimal and unique*
					</p>

					<p class="tiny">
						Mathematically unique. As of 2017 there are 28 competing minimal biasing methods in molecular
						modeling (Bonomi, et al. 2017 <i>Curr. Op. Struct. Bio.</i>)
					</p>

				</section>

				<section class="center" data-background="#FFF">
					<h4> Minimal Bias Example</h4>

					<video data-autoplay height="500" loop>
						<source src="mov/pmf-movie.mp4" type="video/mp4" />
					</video>

				</section>

				<section>
					<h1>Finding $\alpha$</h1>

					$$
					\frac{\partial \left< f(\vec{r}) - \hat{f} \right>^2}{\partial \alpha} = 2\beta\left< f(\vec{r}) -
							\hat{f} \right> \left(\left< f^2(\vec{r})\right> - \left< f(\vec{r})\right>^2\right)
									$$
									<br>
									<p>We used a FTRL variant, but any optimization method works.</p>
									<p>
										<small> White AD & Voth GA.
											<i> J Chem Theory Comput </i>
											<strong> 2014</strong> 10:3023</small>
									</p>
				</section>
			</section>

			<section>

				<section data-background="#FFF">
					<h4>We must use experimental data to model this fragment accurately</h4>

					<div class="container">
						<div>
							<p> EDS Simulation </p>
							<img src="img/simple_1_copy_eds_.png" width="300px">
						</div>
						<div>
							<p> Normal Simulation </p>
							<img src="img/simple_1_copy_control_.png" width="300px">
						</div>
					</div>
					<p class="small">A\(\beta_{21-30}\) 96.2% purity at 0.5mM in 90% H\(_2\)O/D\(_2\)O at pH 6.05. 278 K
						(to avoid
						cross-relaxation) measured \(^1\)H chem shifts. Peaks assigned via TOCSY </p>
				</section>
				<section hide-footer="yes" data-background="#FFF">
					<h4>Improving NMR shifts changes structure</h4>

					<div class="container">
						<div>
							<p> EDS Simulation </p>
							<video data-autoplay width="300" loop>
								<source src="mov/eds-1-c1.mp4" type="video/mp4" />
							</video>
							<img src="img/eds/half_FES_eds_1_copy_colvar_12_13_plus_new.png" width="300px">
						</div>
						<div>
							<p> Normal Simulation </p>
							<video data-autoplay width="300" loop>
								<source src="mov/control-1-c1.mp4" type="video/mp4" />
							</video>
							<img src="img/eds/half_FES_control_ptwte_12_13_plus_new.png" width="300px">
						</div>
					</div>
					<p class="small">Enhanced-Sampling (PT-WTE) was used with 16 replicas</p>
				</section>

				<section class="center" data-background="#000">
					<h4> Four Fragments</h4>
					<video data-autoplay width="600" loop>
						<source src="mov/peptides.mp4" type="video/mp4" />
					</video>
					<aside class="notes">
						This is a demo, not actual Enhanced-Sampling simulation
					</aside>
				</section>

				<section data-background="#FFF">
					<img src="img/eds/composite_fes.svg" class="stretch">
				</section>
				<section class="center" data-background="#FFF">
					<p>How do the peptides interact?</p>

					<div class="row">
						<div class="column">
							<h4> With EDS </h4>
							<img src="img/eds/eds_4_inter_m2.png" width="400px">
						</div>
						<div class="column">
							<h4>PT-WTE</h4>
							<img src="img/eds/cont_4_inter_m2.png" width="400px">
						</div>
					</div>
				</section>
				<section data-background="#FFF">
					<p> Diffusivity of EDS simulation matches NMR Experiment</p>
					<br />
					<table class="small">
						<tr>
							<th>System</th>
							<th>Peptide Diffusivity <br /> [$\times 10^{-6}$ cm<sup>2</sup> / s]</th>
							<th>$p$-value</th>
						</tr>
						<tbody>
							<tr>
								<td>PGSE Exp</td>
								<td> 1.8 </td>
								<td>--</td>
							</tr>
							<tr>
								<td>No EDS</td>
								<td>0.58$\pm$ 0.56</td>
								<td>2$\times 10^{-5}$</td>
							</tr>
							<tr>
								<td>EDS</td>
								<td>1.7$\pm$0.7</td>
								<td>0.78</td>
							</tr>
						</tbody>
					</table>
				</section>
				<section class="center">
					<h3>Conclusions</h3>
					<ol>
						<li>EDS improves agreement with experiment</li>
						<li>Peptides are more aggregation prone when correcting chemical shifts with EDS</li>
						<li>Even using one peptide, with EDS we can see structure similar to what is seen in aggregating
							simulations</li>
					</ol>
					<div class="footnotes">
						<p class="small">
							Amirkulova DB, Chakraborty M, White AD (2020) <i>J Phys Chem B</i>
						</p>
					</div>
				</section>

			</section>
			<section>
				<section class="center">
					<h4> Experiment Directed Simulation (EDS) </h4>

					<p> A maximum entropy (MaxEnt) method which improves a simulation by biasing averages to match
						experimental data via maximum entropy. Can match multiple scalars or probability distributions
						in arbitrary dimensions.
					</p>

					$$
					U'(\vec{r}) = U(\vec{r}) + \sum_i \lambda_i s_i(\vec{r}) + \sum_j \mu_j\left[v(\vec{r})\right]
					$$
				</section>
				<section class="center">

					<h3> Experiment Directed Simulation</h3>
					<br />

					<table class="action-call naked-table">
						<tr>
							<td class="action-call-h">Review Paper:</td>
							<td> Amirkulova D & White AD &nbsp;
								<i> Molecular Simulation </i>
								<strong> 2019</strong> 45 (14-15): 1285-1294
							</td>
						</tr>
						<tr>
							<td class="action-call-h">Implementation:</td>
							<td class="">
								<a src="#">github.com/plumed/plumed2</a>, <a src="#">github.com/ur-whitelab/hoomd-tf</a>
							</td>
						</tr>
						<tr>
							<td class="action-call-h">Sim Engines:</td>
							<td>Gromacs, NAMD, CP2K, DL_Poly, Lammps, Hoomd-blue</td>
						</tr>
					</table>
				</section>

				<section hide-footer="yes">
					<h2>Extensions of EDS</h2>
					<ol class="">
						<li>Uncertainty in experimental data (arbitrary distributions)$^{24}$</li>
						<li>Improving coarse-grained models with experimental data$^{32}$</li>
						<li>Biasing in the NPT ensemble</li>
						<li>As mean field in coarse-graining$^{21}$</li>
						<li>Enhanced sampling$^{38}$</li>
						<li>Working with probabilities, instead of expectations$^7$</li>
						<li>Improving structure of DFT water in AIMD$^{10}$</li>
					</ol>
					<p class="tiny left-align">
						Citations are from Amirkulova D & White AD &nbsp;
						<i> Molecular Simulation </i>
						<strong> 2019</strong> 45 (14-15): 1285-1294
					</p>
				</section>
			</section>
		</div>
	</div>

	<script src="lib/js/head.min.js"></script>
	<script src="js/reveal.js"></script>
	<script src="js/custom.js"></script>

	<script>
		// More info https://github.com/hakimel/reveal.js#configuration
		Reveal.initialize({
			history: true,

			controls: false,
			progress: true,
			center: false,
			viewDistance: 3,
			//theme: 'simple',
			slideNumber: 'c / t',
			transition: 'slide', // none/fade/slide/convex/concave/zoom
			backgroundTransition: 'slide',
			keyboard: {
				39: 'next',
				37: 'prev'
			},
			//math: {
			//	mathjax: 'MathJax/MathJax.js',
			//	config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
			//},
			dependencies: [
				{ src: 'plugin/markdown/marked.js' },
				{ src: 'plugin/markdown/markdown.js' },
				{ src: 'plugin/notes/notes.js', async: true },
				{ src: 'plugin/highlight/highlight.js', async: true, callback: function () { hljs.initHighlightingOnLoad(); } },
				{ src: 'plugin/math/math.js', async: true }
			]
		});

		Reveal.addEventListener('slidechanged', footer_hider);


	</script>
</body>

</html>