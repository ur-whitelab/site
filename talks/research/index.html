<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>AAAI‚òÉÔ∏è</title><link rel="stylesheet" href="index.d3625b52.css"><link rel="stylesheet" href="index.b1dc8c24.css"><link rel="stylesheet" href="index.7e3b4af2.css"><link rel="stylesheet" href="index.12abf21d.css"></head><body> <div class="reveal"> <div class="slides"> <div class="footer"> <p class="footer-img pull-left"> <img src="img/URLogo.png" height="40px" style="margin:0"> </p> <p class="footer-text pull-right"> <span class="footer-link"> <a href="http://thewhitelab.org"> http://thewhitelab.org</a> </span>|&nbsp;&nbsp; <span class="attn">@andrewwhite01 </span> </p> </div> <section class="center" data-background="#ffd700"> <h3 class="attn"> Iterative Molecular Discovery with interpretable Deep Learning </h3> <br> <p> Andrew White <br> <small> University of Rochester <br> Department of Chemical Engineering </small> </p> <p> <small> <i> AI2ASE (AAAI) <br>February, 2022</i></small> </p> </section> <section hide-footer="" center="false" data-background-iframe="https:/thewhitelab.org"> <div class="text-background-dark"> <h1 class="attn">The Whitelab</h1> </div> </section> <section class="center" data-background-color=" #f5f4e9"> <h2>Topics</h2> <ol> <li>Equivariances & Representationüíé</li> <li>Graph Segmentation for CG Simulation‚úÇÔ∏è</li> <li>XAI with Counterfactualsüî¶</li> <li>Open Challengesüßó‚Äç‚ôÄÔ∏è</li> </ol> </section> <section> <section class="center" data-background-color="#ffd700"> <h2>Brief Principles of Deep Learning for Molecules</h2> </section> <section data-auto-animate=""> <h1>Inductive Bias</h1> <p data-id="p"> Explicit choices made in architecture that reflect <span data-id="t">data-generation or solution space.</span> </p> <hr data-id="hr"> <div data-id="footer" class="footnotes"> Battaglia, PW et al. <i>arXiv:1806.01261 </i> <strong> 2018</strong> </div> </section> <section data-auto-animate=""> <h1>Inductive Bias</h1> <p data-id="p"> Explicit choices made in architecture that <strike data-id="t">reflect data-generation or solution space.</strike> <strong class="red">physics</strong> </p> <hr data-id="hr"> <div data-id="footer" class="footnotes"> Battaglia, PW et al. <i>arXiv:1806.01261 </i> <strong> 2018</strong> </div> </section> <section data-auto-animate=""> <h1 class="shrunk-header"> Inductive Bias </h1> <div class="row"> <div class="column small"> <h2>Mol Graph</h2> <img src="mol.a37fa23f.png"> </div> <div class="column small"> <h2>Point Cloud</h2> <img src="3d.a8c18cd4.png"> </div> </div> </section> </section> <section> <section data-auto-animate=""> <h1 class="shrunk-header"> Inductive Bias </h1> <div class="row"> <div class="column small"> <h2>Mol Graph</h2> <img src="mol.a37fa23f.png" height="100px"> <ul> <li>atom permutation equivariance</li> <li>bond permutation equivariance</li> </ul> </div> <div class="column small"> <h2>Point Cloud</h2> <img src="3d.a8c18cd4.png" height="100px"> <ul> <li>atom permutation equivariance</li> <li>translation equivariance</li> <li>rotation equivariance</li> </ul> </div> </div> </section> <section data-auto-animate=""> <h1 class="shrunk-header"> Inductive Bias </h1> <div class="row"> <div class="column small"> <h2>Mol Graph</h2> <img src="mol.a37fa23f.png" height="100px"> <ul> <li class="attn">atom permutation equivariance</li> </ul> </div> <div class="column small tiny"> <table> <thead> <tr> <th style="text-align:right"> </th> <th style="text-align:right"> C</th> <th style="text-align:right"> O</th> <th style="text-align:right"> N</th> <th style="text-align:right"> $\hat{f}(x)$</th> </tr> </thead> <tbody> <tr class="attn" data-id="table-a"> <td style="text-align:right"> 0</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.3</td> </tr> <tr> <td style="text-align:right"> 1</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.8</td> </tr> <tr> <td style="text-align:right"> 2</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.1</td> </tr> <tr class="attn" data-id="table-b"> <td style="text-align:right"> 3</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.0</td> </tr> <tr> <td style="text-align:right"> 4</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.0</td> </tr> <tr> <td style="text-align:right"> 5</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.0</td> </tr> <tr> <td style="text-align:right"> 6</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.2</td> </tr> <tr> <td style="text-align:right"> 7</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.5</td> </tr> <tr> <td style="text-align:right"> 8</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.9</td> </tr> <tr> <td style="text-align:right"> 9</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.6</td> </tr> <tr> <td style="text-align:right">10</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.3</td> </tr> </tbody> </table> </div> </div> </section> <section data-auto-animate="" data-auto-animate-unmatched="false"> <h1 class="shrunk-header"> Inductive Bias </h1> <div class="row"> <div class="column small"> <h2>Mol Graph</h2> <img src="mol.a37fa23f.png" height="100px"> <ul> <li class="attn">atom permutation equivariance</li> </ul> </div> <div class="column small tiny"> <table> <thead> <tr> <th style="text-align:right"> </th> <th style="text-align:right"> C</th> <th style="text-align:right"> O</th> <th style="text-align:right"> N</th> <th style="text-align:right"> $\hat{f}(x)$</th> </tr> </thead> <tbody> <tr class="attn" data-id="table-b"> <td style="text-align:right"> 3</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.0</td> </tr> <tr> <td style="text-align:right"> 1</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.8</td> </tr> <tr> <td style="text-align:right"> 2</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.1</td> </tr> <tr class="attn" data-id="table-a"> <td style="text-align:right"> 0</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.3</td> </tr> <tr> <td style="text-align:right"> 4</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.0</td> </tr> <tr> <td style="text-align:right"> 5</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.0</td> </tr> <tr> <td style="text-align:right"> 6</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.2</td> </tr> <tr> <td style="text-align:right"> 7</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.5</td> </tr> <tr> <td style="text-align:right"> 8</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.9</td> </tr> <tr> <td style="text-align:right"> 9</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.6</td> </tr> <tr> <td style="text-align:right">10</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 1</td> <td style="text-align:right"> 0</td> <td style="text-align:right"> 0.3</td> </tr> </tbody> </table> </div> </div> </section> <section data-auto-animate=""> <h1 class="shrunk-header"> Inductive Bias </h1> <div class="row"> <div class="column small"> <h2>Example</h2> <video src="mov/pas-traj.mp4" width="640px" data-autoplay="" loop></video> </div> <div class="column small"> <h2>Point Cloud</h2> <img src="3d.a8c18cd4.png" height="100px"> <ul> <li>atom permutation equivariance</li> <li class="attn">translation equivariance</li> <li class="attn">rotation equivariance</li> </ul> </div> </div> </section> </section> <section data-auto-animate=""> <h3> Representation and Model Decisions </h3> <div class="row"> <div class="column small"> <h2>SMILES</h2> <div style="height:100px"> <pre><code data-trim="">
							CCCC1=CC=CC=C1C(=O)
							N2CCCC[C@H]2C3CCCC3 </code>
						</pre> </div> <p>Sequence Network <br> (1D Conv, RNN, Transformer)</p> </div> <div class="column small"> <h2>Mol Graph</h2> <img src="mol.a37fa23f.png" height="100px"> <p>Graph Neural Networks</p> </div> <div class="column small"> <h2>Points</h2> <img src="3d.a8c18cd4.png" height="100px"> <p>Equivariant Neural Networks</p> </div> </div> </section> <section data-auto-animate=""> <h3> Representation and Model Decisions </h3> <div class="row"> <div class="column small"> <h2>SMILES</h2> <p class="attn">Preferred</p> </div> <div class="column small"> <h2>Mol Graph</h2> <p class="attn">If you must</p> </div> <div class="column small"> <h2>Points</h2> <p class="attn">Avoid</p> </div> </div> </section> <section> <h1>The Power of Text</h1> <p>Text is excellent at predicting scalars &mdash; invariant to permutations.<sup>*</sup> Training is fast, implementations are easy, available in javascriptüöÄ</p> <hr> <div class="footnotes"> Via canonicalization </div> </section> <section data-background-iframe="https://whitead.github.io/molecule-dream/"> </section> <section> <section data-background-color="#ffd700"> <h2>Graph Segmentation for CG Simulation‚úÇÔ∏è</h2> <br> <p class="left-align"> Li, Z. <i>et al</i>. Graph neural network based coarse-grained mapping prediction (2020).</p> <div class="paper-info"><a href="https://twitter.com/andrewwhite01/status/1422562950401990658">tweet</a> | <a href="https://pubs.rsc.org/en/content/articlehtml/2020/sc/d0sc02458a">link</a> | <a href="https://pubs.rsc.org/en/content/articlepdf/2020/sc/d0sc02458a">pdf</a> | <a href="https://github.com/rochesterxugroup/DSGPM">code</a> </div> </section> <section data-background="#FFF"> <h2 class="attn">Molecular Dynamics History</h2> <img src="img/sim-future.png" class="stretch"> </section> <section hide-footer=""> <h2>Extrapolating</h2> <table style="font-size:.8em"> <tbody> <tr> <th>Year </th> <th>Event</th> </tr> <tr> <td>2023</td> <td>The first simulation of every atom in a ribosome for 10 milliseconds</td> </tr> <tr> <td>2038</td> <td>The first simulation of every atom in a virus for 1 second</td> </tr> <tr> <td>2131</td> <td>The first simulation of every atom of a cell for 1 hour</td> </tr> <tr> <td>2191</td> <td>We can simulate every atom of every cell in a heart for 1 heartbeat</td> </tr> <tr> <td>2227</td> <td>Every atom of every cell in a human brain can be simulated as fast they move in a human brain</td> </tr> </tbody> </table> </section> <section class="center" data-background-size="contain" data-background-color="#ffdd00"> <h3>Coarse-grained modeling</h3> <p> Remove degrees of freedom that are unnecessary to model the physics. </p> <br> <div class="row"> <div class="column"> <h4 class="red"> Little Work or Theory </h4> \[ R^{\textrm{FG}} \rightarrow R^{\textrm{CG}} \] </div> <div class="column"> <h4>Excellent Theory</h4> \[ U\left(R^{\textrm{FG}}\right) \rightarrow U\left(R^{\textrm{CG}}\right) \] </div> </div> </section> <section data-background-video="mov/map-1.mov" data-background-size="contain" data-background-color="#000"> </section> <section data-background-video="mov/map-2.mov" data-background-size="contain" data-background-color="#000"> </section> <section data-background-video="mov/map-3-trim.mov" data-background-size="contain" data-background-color="#000" hide-footer="yes"> </section> <section data-background-video="mov/count-1.mov" data-background-size="contain" data-background-color="#000"> </section> <section data-background-video="mov/count-2.mov" data-background-size="contain" data-background-color="#000"> </section> <section data-background-video="mov/count-3.mov" data-background-size="contain" data-background-color="#000"> </section> <section hide-footer="" data-background="#FFF"> <h3>Enumerating Mapping Operators</h3> <img src="counts.fb720a65.png"> <div class="footnotes"> Maghesree C., et al. <i> Journal of Chemical Physics </i> <strong> 2018</strong> </div> </section> <section class="center" data-background-size="contain" data-background-color="#ffdd00"> <h2>Can we make this a supervised problem?</h2> </section> <section hide-footer=""> <h3>2,000 Expert Generated Mappings</h3> <img src="webapp_demo.b6295b6a.png" width="700px"> <p>Humans agree about 90% of the time</p> </section> <section class="center"> <h2>Equivariances</h2> <ol> <li>Bond permutation equivariant</li> <li>Atom permutation equivariant</li> </ol> <p class="attn">Use Gated Graph Neural Network</p> </section> <section data-background-color="#FFF"> <h3>Graph Neural Network + Spectral Clustering</h3> <img src="method.188b865e.png" width="600px"> <div class="footnotes"> Yujia Li, Daniel Tarlow, Marc Brockschmidt, and Richard Zemel. Gated graph sequence neural networks. arXiv preprint arXiv:1511.05493, 2015. </div> </section> <section class="center" data-background-color="#FFF"> <h3>Results</h3> <img src="gt.3bbe6820.png"> </section> <section hide-footer="" class="center"> <table class="small"> <thead> <tr class="header"> <th style="text-align:left">Method</th> <th style="text-align:center">AMI</th> <th style="text-align:center">Cut Prec.</th> <th style="text-align:center">Cut recall</th> <th style="text-align:center">Cut F1-score</th> </tr> </thead> <tbody> <tr class="odd"> <td style="text-align:left">GAP <span class="citation" data-cites="Nazi2019"></span> </td> <td style="text-align:center">0.33</td> <td style="text-align:center">0.47</td> <td style="text-align:center">0.73</td> <td style="text-align:center">0.54</td> </tr> <tr class="even"> <td style="text-align:left">Graclus <span class="citation" data-cites="Dhillon2007"></span></td> <td style="text-align:center">0.45</td> <td style="text-align:center">0.58</td> <td style="text-align:center">0.81</td> <td style="text-align:center">0.65</td> </tr> <tr class="odd"> <td style="text-align:left">ClusterNet <span class="citation" data-cites="Wilder_2019_NeurIPS"></span></td> <td style="text-align:center">0.52</td> <td style="text-align:center">0.64</td> <td style="text-align:center">0.62</td> <td style="text-align:center">0.58</td> </tr> <tr class="even"> <td style="text-align:left">METIS <span class="citation" data-cites="Karypis_1998_SIAM"></span></td> <td style="text-align:center">0.56</td> <td style="text-align:center">0.63</td> <td style="text-align:center">0.56</td> <td style="text-align:center">0.58</td> </tr> <tr class="odd"> <td style="text-align:left">Cut Cls.</td> <td style="text-align:center">0.67</td> <td style="text-align:center">0.75</td> <td style="text-align:center">0.73</td> <td style="text-align:center">0.73</td> </tr> <tr class="even"> <td style="text-align:left">Spec. Cluster. <span class="citation" data-cites="Ng_2002_NeurIPS"></span></td> <td style="text-align:center">0.73</td> <td style="text-align:center">0.75</td> <td style="text-align:center">0.75</td> <td style="text-align:center">0.75</td> </tr> <tr class="odd"> <td style="text-align:left" class="red"><strong></strong> (Ours)</td> <td style="text-align:center"><strong>0.79</strong></td> <td style="text-align:center"><strong>0.80</strong></td> <td style="text-align:center"><strong>0.80</strong></td> <td style="text-align:center"><strong>0.80</strong></td> </tr> <tr class="even"> <td style="text-align:left">Human</td> <td style="text-align:center">0.81</td> <td style="text-align:center">0.81</td> <td style="text-align:center">0.81</td> <td style="text-align:center">0.81</td> </tr> </tbody> </table> </section> <section data-background-color="#383838"> <a href="https://colab.research.google.com/github/rochesterxugroup/DSGPM/blob/master/colab/DSGPM.ipynb" rel="nofollow"><img src="https://camo.githubusercontent.com/84f0493939e0c4de4e6dbe113251b4bfb5353e57134ffd9fcab6b8714514d4d1/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667" alt="Open In Colab" data-canonical-src="https://colab.research.google.com/assets/colab-badge.svg" style="max-width:100%"></a> <img src="demo.0c80e083.png"> </section> </section> <section> <section data-background-color="#ffd700"> <h2>XAI with Counterfactualsüî¶</h2> <br> <p class="left-align"> Wellawatte, G. P., Seshadri, A. & White, A. D. Model agnostic generation of counterfactual explanations for molecules. (2021).</p> <div class="paper-info"><a href="https://twitter.com/andrewwhite01/status/1427268134654914560">tweet</a> | <a href="https://doi.org/10.33774/chemrxiv-2021-4qkg8">link</a> | <a href="https://chemrxiv.org/engage/api-gateway/chemrxiv/assets/orp/resource/item/6115baf04cb4797dc42df605/original/model-agnostic-generation-of-counterfactual-explanations-for-molecules.pdf">pdf</a> | <a href="https://github.com/ur-whitelab/exmol">code</a> </div> </section> <section data-background="#CCC" data-auto-animate="" hide-footer=""> <p>What is an explanation of a <span class="red">prediction</span>?</p> <ol class="small"> <li class="fragment"><span class="attn">Justification:</span> reasoning for using a prediction, like test error</li> <li class="fragment"><span class="attn">Interpretability:</span> "the degree to which an observer can understand the cause of a decision"</li> <li class="fragment"><span class="attn">Explanation:</span> a presentation of information intended for humans that give the context and cause for a prediction</li> </ol> <hr> <div class="footnotes"> Miller T, <i>Artificial Intelligence</i> <strong>2019</strong> </div> </section> <section data-background="#CCC"> <h2>Instance Explanations</h2> <ol> <li>Feature Explanation: which features contributed most to outcome?</li> <li class="fragment">Contrastive Explanation: what would the outcome be if the features were different?</li> <li class="fragment">Counterfactual Explanation: what are the closest features with a different outcome?</li> </ol> </section> <section data-background="#CCC" class="center"> <h2>Counterfactual</h2> <p class="left-align">My grant proposal was rejected from NSF. <span class="red">If I had correctly formatted my references, it would have been funded.</span> </p> </section> <section hide-footer="" data-background="#FFF"> <h2>Chemistry Counterfactual</h2> <img src="cf.14129426.jpg"> </section> <section data-background="#CCC"> <p class="left-align">Counterfactuals are solution to optimization. Given prediction $x,\hat{f}(x)$, find $x'$ with</p> <br> \begin{aligned} \texttt{minimize}&\quad d(x, x')\\ \texttt{such that}&\quad \hat{f}(x) \neq \hat{f}(x') \end{aligned} <p class="left-align">Challenging because optimization requires $\nabla_x\hat{f}(x)$</p> </section> <section data-background="#FFF" hide-footer=""> <p>Use STONED Method to enumerate chemical spcae</p> <img src="mols.7004219a.gif"> </section> <section data-background-color="#FFF" data-background="img/cartoon.png" data-background-size="contain" hide-footer=""> </section> <section data-background="#FFF" hide-footer=""> <h2>Output</h2> <img src="gnn-space.9df4a8e2.png" class="r-stretch"> </section> <section class="center" data-background="#CCC"> <p>pip install exmol</p> <img src="img/carbon.svg" class="r-stretch"> </section> </section> <section> <div class="center" data-background="#ffd700"> Current Challengesüßó‚Äç‚ôÄÔ∏è </div> </section> <section data-background-video="mov/mols_1.mov" data-background-size="contain" data-background-color="#000"> </section> <section data-background-video="mov/mols_2.mov" data-background-size="contain" data-background-color="#000"> </section> <section data-background-video="mov/mols_3.mov" data-background-size="contain" data-background-color="#000"> </section> <section data-background-video="mov/mols_4.mov" data-background-size="contain" data-background-color="#000"> </section> <section data-background-video="mov/rep_1.mov" data-background-size="contain" data-background-color="#000"> </section> <section data-background-video="mov/rep_2.mov" data-background-size="contain" data-background-color="#000"> </section> <section data-background-video="mov/rep_3.mov" data-background-size="contain" data-background-color="#000"> </section> <section data-background-video="mov/rep_4.mov" data-background-size="contain" data-background-color="#000"> </section> <section data-background-video="mov/rep_5.mov" data-background-size="contain" data-background-color="#000"> </section> <section data-background-video="mov/rep_6.mov" data-background-size="contain" data-background-color="#000"> </section> <section class="center" data-background-video="mov/traj_cm.mp4" data-background-video-loop="no"> <div class="text-background-dark"> <h1 class="attn">Discussion</h1> </div> </section> </div> </div> <script type="module" src="index.1cde4283.js"></script><script src="index.e7fbab18.js" nomodule="" defer></script> </body></html>