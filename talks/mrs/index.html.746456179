<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>Chem</title>

	<link rel="stylesheet" href="/index.d0573f18.css">
	<link rel="stylesheet" href="/index.16010b5d.css">
	<link rel="stylesheet" href="/index.3c039aaf.css">
	<link rel="stylesheet" href="/index.ed891881.css">
</head>

<body>
	<div class="reveal">

		<div class="slides">

			<div style="" class="footer">
				<p class="footer-img pull-left">
					<img src="/img/URLogo.png" height="40px" style="margin: 0;">
				</p>
				<p class="pull-right footer-text">
					<span class="footer-link">
						<a href="http://thewhitelab.org"> http://thewhitelab.org</a>
					</span>|&nbsp;&nbsp; <span class="attn">@andrewwhite01 </span>
				</p>
			</div>
			<section class="center" data-background="#ffdd00">
				Iterative Peptide Biomaterials Discovery with Maximum Entropy Methods and Deep Learning

				<br>

				<p class="">
					Andrew White <br>
					<small>
						University of Rochester <br>
						Department of Chemical Engineering </small>

				</p>

				<p class="">
					<small> <i>
							Machine Learning and Artificial Intelligence in Biomaterials Design and Development
							<br>October, 2021</i></small>
				</p>
			</section>
			<section hide-footer="" center="false" data-background-iframe="https://ur-whitelab.github.io/site/">
				<div class="text-background-dark">
					<h1 class="attn">The Whitelab</h1>
				</div>
			</section>
			<section hide-footer="">
				<h2>âœ¨deep
					learningâœ¨</h2>
				<p class="left-align">Given $\vec{x}$ and $y$, find a function $\hat{f}(\vec{x})$ that predicts
					$\hat{y}$</p>

				\[
				\hat{y} = \sigma\left(\mathbf{W}X + b\right)
				\]

				<ul class="left-align">
					<li>$\sigma$ non-linear <strong>activation</strong></li>
					<li>$\mathbf{W}$ trainable weights</li>
					<li>$\mathbf{W}$ trainable bias</li>
				</ul>
				<p class="left-align">My book on it: <a href="https://dmol.pub">dmol.pub</a></p>
			</section>
			<section data-background="#FFF">
				<h2>Example of a Neural Network</h2>
				<img class="r-stretch" src="/img/nn.png">
			</section>
			<section>
				<h1>What is possible with</h1>
				\[
				\hat{y} = \sigma\left(\mathbf{W}X + b\right)
				\]
			</section>
			<section hide-footer="" data-auto-animate="">
				<p>$x$ is "Robot doing chemistry", $y$ is image</p>
				<img src="/robot-chem.4b70ef78.png" class="r-stretch">
				<p class="small">Model: VQGAN+CLIP</p>

			</section>
			<section hide-footer="" data-auto-animate="">
				<p>$x$ is "Robot doing chemistry", $y$ is image</p>
				<img src="/robot-chem-3d.2736ae10.png" class="r-stretch">
				<p class="small">Model: VQGAN+CLIP</p>
			</section>
			<section data-auto-animate="" hide-footer="" class="center">
				<p>$x$ is "Should I run the blender at 3am in the morning when my family is sleeping?", $y$ is morality
				</p>
				<img src="/img/morality.png" class="r-stretch">
				<p class="small">Model: Delphi</p>
			</section>
			<section data-auto-animate="" hide-footer="" class="center">
				<img src="/img/morality2.png" class="r-stretch">
				<p class="small">Model: Delphi</p>
			</section>
			<section>
				<section data-background-color="#ffdd00">
					<h2>Iterative Design of PeptidesðŸ”­</h2>
					<br><br>
					<p class="left-align"> Barrett R, White AD. Investigating Active Learning and Meta-Learning for
						Iterative Peptide Design
						(2021).</p>
					<div class="paper-info"><a href="https://github.com/ur-whitelab/peptide-ai">code</a> | <a href="https://pubs.acs.org/doi/10.1021/acs.jcim.0c00946">link</a> | <a href="https://pubs.acs.org/doi/pdf/10.1021/acs.jcim.0c00946">pdf</a>
					</div>
				</section>
				<section class="center" data-background="#ffdd00">
					<p>Can we overcome data sparsity in peptide design by incorporating AI at the first experiment?
				</p></section>
				<section class="center" hide-footer="">
					<h4>Learning to learn with peptide design</h4>

					<p>Can we develop a deep learning network and learning procedure to
						design across 12 peptide tasks?
					</p>

					<div class="row">
						<div class="column">
							<ul>
								<li>Antimicrobial</li>
								<li>Anticancer</li>
								<li>Antifungal</li>
								<li>Hemolytic</li>
								<li>AntiMRSA</li>
								<li>AntiHIV</li>
							</ul>
						</div>
						<div class="column">
							<ul>
								<li>Antiviral</li>
								<li>Antiparasital</li>
								<li>Soluble</li>
								<li>SHP2 Binders</li>
								<li>TULA2 Binder</li>
								<li>Anti-fouling</li>
							</ul>
						</div>
					</div>
				</section>
				<section hide-footer="" data-background-color="white">
					<h4>Network Architecture</h4>
					<img src="/network_diagram.5552b107.png" class="r-stretch">
					<p>Inductive bias: permutation invariance</p>
				</section>
				<section hide-footer="yes">
					<h4>Deep learning model performance</h4>
					<table class="tiny">
						<thead>
							<th>Data</th>
							<th>Model Accuracy</th>
						</thead>

						<tr>
							<td> antibacterial </td>
							<td> 0.88 </td>
						</tr>
						<tr>
							<td> anticancer </td>
							<td> 0.82 </td>
						</tr>
						<tr>
							<td> antifungal </td>
							<td> 0.87 </td>
						</tr>
						<tr>
							<td> antiHIV </td>
							<td> 0.84 </td>
						</tr>
						<tr>
							<td> antiMRSA </td>
							<td> 0.96 </td>
						</tr>
						<tr>
							<td> antiparasital </td>
							<td> 0.89
						</td></tr>
						<tr>
							<td> antiviral </td>
							<td> 0.76 </td>
						</tr>
						<tr>
							<td> hemolytic </td>
							<td> 0.98 </td>
						</tr>
						<tr>
							<td> soluble </td>
							<td class="red"> 0.63 </td>
						</tr>
						<tr>
							<td> shp2 </td>
							<td> 0.90 </td>
						</tr>
						<tr>
							<td> tula2 </td>
							<td> 0.83 </td>
						</tr>
						<tr>
							<td> Anti-fouling </td>
							<td> 0.89 </td>
						</tr>

					</table>
				</section>
				<section class="center">
					<h4>Active Learning</h4>
					<p>Can we maximize accuracy after training with 50 examples? Must develop strategy
						to choose which peptide to use next (utility function/acquisition function)
					</p>
				</section>
				<section class="center" data-background="#FFF">
					<h2>Uncertainty Minimization Strategy</h2>
					<img src="/ucmin_training_diagram.d76b6fb3.png" class="r-stretch">
				</section>
				<section class="center" data-background="#FFF">
					<h3> Training Curve</h3>
					<img src="/example.92622e6c.png" width="400px">
				</section>
				<section data-background-color="white" hide-footer="yes">
					<h4> Query By Committee Disagreement</h4>
					<img src="/qbc.56a84e27.png" class="stretch">
					<p class="attn"> No improvement over random</p>
				</section>
				<section hide-footer="" class="center">
					<h3>Meta-Learning + Active Learning</h3>

					<p>Now, we optimize hyperparameters across tasks. Use leave-one-out cross-validation
						for datasets, early stopping for regularization.</p>

					$$
					\psi_{j+1} = \psi_j - \eta \nabla_\psi \mathcal{L}\left[U(\psi_j, K)\right]
					$$

					<br>
					<br>

					<div class="footnotes">
						<ul>
							<li> Finn C et. al. <strong>2017</strong> arXiv:1703.03400</li>
							<li> Nichol A et. al. <strong>2018</strong> arXiv:1803.02999
							</li>
						</ul>
					</div>
				</section>
				<section data-background-color="white" hide-footer="yes">
					<h4> Meta-Learning with Active Learning</h4>
					<img src="/qbc-ml.0ee0d63d.png" class="stretch">
					<p class="attn"> Consistently better</p>
				</section>
				<section data-background-color="white" hide-footer="yes">
					<h4> More Samples</h4>
					<img src="/qbc-ml-long.13307752.png" class="stretch">
				</section>
				<section data-background-color="white" hide-footer="yes">
					<h4> Comparing all methods</h4>
					<img src="/accuracy_barchart.2edee67a.png" class="stretch">
				</section>
				<section class="center">
					<h3>Conclusions</h3>
					<ul class="small">
						<li>Deep learning provides good performance across many peptide tasks (all greater than 85%
							accuracy, many above 95%)</li>
						<li>Meta-learning allows improved accuracy by leveraging past data. Very important at 10
							examples</li>
						<li>Active learning can be a successful strategy for choosing which peptide to test,
							significantly so when combined with meta-learning and at 50 examples</li>
					</ul>
				</section>
				<section>
					<h2>Taxonomy</h2>
					<div class="row">
						<div class="column">
							<h3>Few-shot learning</h3>
							<p>Reduce amount of data necessary to learn. One approach is <span class="attn">Meta-learning</span></p>
						</div>
						<div class="column">
							<h3>Active Learning</h3>
							<p>Choose which experiment to do next to maximize accuracy across all possible experiments.</p>
						</div>
					</div>
				</section>
				<section>
					<h2>Siblings of active learning</h2>
					<div class="row">
						<div class="column">
							<h3>Bayesian Optimization</h3>
							<p>Maximize property</p>
						</div>
						<div class="column">
							<h3>Active Learning</h3>
							<p>Maximize accuracy of property prediction across all possible experiments.</p>
						</div>
						<div class="column">
							<h3>Bayesian Optimization</h3>
							<p>Maximize property</p>
						</div>
					</div>
				</section>
			</section>
			<section>
				<section data-background-color="#ffdd00">
					<h2>XAI with CounterfactualsðŸ”¦</h2>
					<br>
					<p class="left-align"> Wellawatte, G. P., Seshadri, A. & White, A. D. Model agnostic generation of
						counterfactual
						explanations for molecules. (2021).</p>
					<div class="paper-info"><a href="https://twitter.com/andrewwhite01/status/1427268134654914560">tweet</a> | <a href="https://doi.org/10.33774/chemrxiv-2021-4qkg8">link</a> | <a href="https://chemrxiv.org/engage/api-gateway/chemrxiv/assets/orp/resource/item/6115baf04cb4797dc42df605/original/model-agnostic-generation-of-counterfactual-explanations-for-molecules.pdf">pdf</a>
						| <a href="https://github.com/ur-whitelab/exmol">code</a> </div>
				</section>
				<section data-background="#CCC" data-auto-animate="" hide-footer="">
					<p>What is an explanation of a <span class="red">prediction</span>?</p>
					<ol class="small">
						<li class="fragment"><span class="attn">Justification:</span> reasoning for using a prediction,
							like test
							error</li>
						<li class="fragment"><span class="attn">Interpretability:</span> "the degree to which an
							observer can
							understand the cause of a
							decision"</li>
						<li class="fragment"><span class="attn">Explanation:</span> a presentation of information
							intended for humans
							that give the context and
							cause for a prediction</li>
					</ol>

					<hr>

					<div class="footnotes">
						Miller T,
						<i>Artificial Intelligence</i>
						<strong>2019</strong>
					</div>
				</section>
				<section data-background="#CCC">
					<h2>Instance Explanations</h2>
					<ol>
						<li>Feature Explanation: which features contributed most to outcome?</li>
						<li class="fragment">Contrastive Explanation: what would the outcome be if the features were
							different?</li>
						<li class="fragment">Counterfactual Explanation: what are the closest features with a different
							outcome?</li>
					</ol>
				</section>
				<section data-background="#CCC" class="center">
					<h2>Counterfactual</h2>
					<p class="left-align">My grant proposal was rejected from NSF.
						<span class="red">If I had correctly formatted my references, it would have been funded.</span>
					</p>
				</section>
				<section hide-footer="" data-background="#FFF">
					<h2>Chemistry Counterfactual</h2>
					<img src="/cf.3662ddd6.jpg">
				</section>
				<section data-background="#CCC">

					<p class="left-align">Counterfactuals are solution to optimization. Given prediction $x,\hat{f}(x)$,
						find $x'$ with</p>
					<br>
					\begin{aligned}
					\texttt{minimize}&\quad d(x, x')\\
					\texttt{such that}&\quad \hat{f}(x) \neq \hat{f}(x')
					\end{aligned}
					<p class="left-align">Challenging because optimization requires $\nabla_x\hat{f}(x)$</p>
				</section>
				<section data-background="#FFF" hide-footer="">
					<p>Use STONED Method to enumerate chemical spcae</p>
					<img src="/mols.331a5d65.gif">

				</section>
				<section data-background-color="#FFF" data-background="img/cartoon.png" data-background-size="contain" hide-footer="">
				</section>
				<section data-background="#FFF" hide-footer="">
					<h2>Output</h2>
					<img src="/gnn-space.08699b29.png" class="r-stretch">
				</section>
				<section class="center" data-background="#CCC">
					<p>pip install exmol</p>
					<img src="/img/carbon.svg" class="r-stretch">
				</section>
			</section>
			<section>
				<h1>Synthesizing Code from Natural Language</h1>
			</section>
			<section>
				<img src="/img/nlcc.svg">
			</section>
			<section hide-footer="" data-background="#CCC">
				<p>Perspective on GPT-3/Codex in chemistry</p>
				<img src="/img/perspective.png" class="r-stretch">
			</section>
			<!-- <section hide-footer data-background="#CCC">
				<h2>Emoji Science</h2>
				<div class="small row">
					<div class="column">
						<p>https://github.com/whitead/emoji-math </p>
					</div>
					<div class="column">
						<p>https://github.com/whitead/emoji-chem</p>
					</div>
				</div>
				<div class="row">
					<div class="column">
						<img src="img/emath.svg" width="r-stretch">
					</div>
					<div class="column">
						<img src="img/echem.png" width="r-stretch">
					</div>
				</div>
			</section> -->
			<section class="center">
				<h1>Discussion</h1>
			</section>
		</div>
	</div>
	<script src="/index.2bd76647.js" defer=""></script>
</body>

</html>